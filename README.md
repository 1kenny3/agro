# Агропайплайн - Классификация сельскохозяйственных культур и оценка качества

## Описание проекта

Автоматизированный пайплайн для классификации сельскохозяйственных культур (пшеница, ячмень, кукуруза) по фотографиям, оценки их качества и прогнозирования урожайности.

## Функционал

### 1. Классификация культур
- **Входные данные**: фото растений (листья, колосья, початки, общий вид поля)
- **Выходные данные**: метка класса (пшеница, ячмень, кукуруза)
- **Точность**: ≥ 90% на тестовой выборке

### 2. Оценка качества
- **Параметры оценки**:
  - Наличие болезней (ржавчина, мучнистая роса, фузариоз)
  - Степень зрелости (незрелый, спелый, перезрелый)
  - Повреждения (вредители, засуха, переувлажнение)
- **Выходные данные**: 
  - Бинарный показатель (хорошее/плохое качество)
  - Детальный отчет по шкале 1-5

### 3. Прогнозирование урожайности
- Прогноз урожайности в тоннах/га
- Вероятностная оценка (±15%)

## Технический стек

- **Backend**: FastAPI
- **ML модели**: PyTorch (ResNet, EfficientNet для классификации)
- **Computer Vision**: OpenCV, PIL
- **Frontend**: Streamlit
- **API**: REST API с документацией Swagger

## Структура проекта

```
agro/
├── src/
│   ├── models/          # ML модели
│   ├── api/             # FastAPI приложение
│   ├── preprocessing/   # Предобработка изображений
│   ├── utils/           # Вспомогательные функции
│   └── config/          # Конфигурация
├── data/
│   ├── raw/             # Исходные данные
│   ├── processed/       # Обработанные данные
│   └── models/          # Сохраненные модели
├── notebooks/           # Jupyter ноутбуки для экспериментов
├── tests/               # Тесты
├── frontend/            # Streamlit интерфейс
└── docker/              # Docker конфигурация
```

## Установка и запуск

1. Установка зависимостей:
```bash
pip install -r requirements.txt
```

2. Запуск API:
```bash
uvicorn src.api.main:app --reload
```

3. Запуск веб-интерфейса:
```bash
streamlit run frontend/app.py
```

## API Endpoints

- `POST /classify` - Классификация культуры
- `POST /quality` - Оценка качества
- `POST /yield` - Прогнозирование урожайности
- `POST /analyze` - Комплексный анализ

## Использование

### Через API
```python
import requests

# Классификация культуры
response = requests.post(
    "http://localhost:8000/classify",
    files={"image": open("crop_image.jpg", "rb")}
)
result = response.json()
```

### Через веб-интерфейс
Откройте браузер по адресу `http://localhost:8501` после запуска Streamlit приложения.

## Модели

### Классификация культур
- **Архитектура**: EfficientNet-B4
- **Предобученная модель**: ImageNet
- **Fine-tuning**: На данных сельскохозяйственных культур

### Оценка качества
- **Детекция болезней**: YOLO v8
- **Сегментация**: U-Net
- **Классификация зрелости**: ResNet-50

### Прогнозирование урожайности
- **Модель**: XGBoost + временные ряды
- **Признаки**: плотность растений, здоровье, внешние факторы

## Датасет

Используются данные из:
- Plant Pathology Challenge (Kaggle)
- Crop Disease Dataset
- Собственные данные с полей

## Лицензия

MIT License 

 python fix_classification_models.py



# Использовать точно настроенную систему (рекомендуется)
python manage_recognition.py finetuned

# Проверить статус всех систем
python manage_recognition.py status

# Вернуться к базовой улучшенной системе
python manage_recognition.py enhanced

# Вернуться к исходной системе
python manage_recognition.py standard